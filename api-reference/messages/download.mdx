---
title: "Baixar Arquivo"
api: "POST /messages/download"
description: "Baixar arquivo de uma mensagem de mídia"
---

Realiza o download de arquivos associados a mensagens de mídia (imagem, vídeo, áudio ou documento).

## Casos de Uso

<AccordionGroup>
  <Accordion title="Download de Áudios" icon="waveform">
    Permite baixar áudios em diferentes formatos:
    - **MP3** (padrão) - usando `generate_mp3: true`
    - **OGG** (formato original) - usando `generate_mp3: false`

    Ideal para armazenamento ou processamento posterior.

  </Accordion>

  <Accordion title="Transcrição de Áudio" icon="microphone">
    Converte mensagens de voz em texto automaticamente.

    **Requisitos:**
    - Chave da API OpenAI configurada
    - Parâmetro `transcribe: true`

    A chave pode ser salva na instância para reutilização automática.

  </Accordion>

  <Accordion title="Download de Mídia Citada" icon="quote-right">
    Útil para baixar conteúdo original de status do WhatsApp.

    **Exemplo de uso:**
    Quando um cliente responde a uma promoção/status, você pode baixar a mídia original para entender sobre qual produto/oferta ele está perguntando.

    Use `download_quoted: true` para este cenário.

  </Accordion>

  <Accordion title="Formatos de Retorno" icon="file-export">
    Escolha como receber o arquivo:
    - **URL pública** (padrão) - arquivo salvo e acessível via link
    - **Base64** - conteúdo codificado em string
    - **Ambos** - URL + Base64
    - **Nenhum** - apenas processa (ex: transcrição)
  </Accordion>
</AccordionGroup>

### Authorization

<ParamField path="api_key" type="string" required>
  Chave de autenticação da sua conexão, utilizada no header Authorization como
  **Bearer** Token. <br />
  Você encontra sua API Key no botão **API** da sua conexão no painel ZapClass. <br />
  A chave sempre começa com o prefixo `zc_`. <br />
  Exemplo: `zc_6FrX2qjM4bHT9pR6cC0sD8wLkG3nE2tZfV5uN1aP`
</ParamField>

### Body Parameters

<ParamField path="id" type="string" required>
  ID da mensagem contendo o arquivo. <br />
  Exemplo: `7EB0F01D7244B421048F0706368376E0`
</ParamField>

<ParamField path="base64" type="boolean">
  Se verdadeiro, retorna o conteúdo em base64. <br />
  Padrão: `false` <br />
  Exemplo: `true`
</ParamField>

<ParamField path="mp3" type="boolean">
  Para áudios, define formato de retorno. <br />
  - `true`: Retorna MP3 <br />
  - `false`: Retorna OGG <br />
  Padrão: `true` <br />
  Exemplo: `true`
</ParamField>

<ParamField path="link" type="boolean">
  Salva e retorna URL pública do arquivo. <br />
  Padrão: `true` <br />
  Exemplo: `true`
</ParamField>

<ParamField path="quoted" type="boolean">
  Baixa mídia da mensagem citada ao invés da mensagem principal. <br />
  Útil para baixar conteúdo original de status do WhatsApp. <br />
  Padrão: `false` <br />
  Exemplo: `true`
</ParamField>

<ParamField path="openai_api_key" type="string">
  Chave da API OpenAI para transcrição áudios para texto. <br />
  Exemplo: `sk-proj-...`
</ParamField>

<Info>
  **Comportamento padrão:** - Áudios são retornados como MP3 - Downloads incluem
  URL pública do arquivo - Transcrição requer chave OpenAI configurada
</Info>

<RequestExample>

```bash cURL
curl -X POST https://zapclass.com.br/api/messages/download \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer zc_6FrX2qjM4bHT9pR6cC0sD8wLkG3nE2tZfV5uN1aP" \
  -d '{
    "id": "7EB0F01D7244B421048F0706368376E0",
    "mp3": true,
    "base64": true,
    "link": true,
    "quoted": true,
    "openai_api_key": "sk-proj-..."
  }'
```

```javascript JavaScript
const response = await fetch("https://zapclass.com.br/api/messages/download", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    Authorization: "Bearer zc_6FrX2qjM4bHT9pR6cC0sD8wLkG3nE2tZfV5uN1aP",
  },
  body: JSON.stringify({
    id: "7EB0F01D7244B421048F0706368376E0",
    mp3: true,
    base64: true,
    link: true,
    quoted: true,
    openai_api_key: "sk-proj-...",
  }),
});
```

```php PHP
<?php
$ch = curl_init('https://zapclass.com.br/api/messages/download');

$payload = [
    "id" => "7EB0F01D7244B421048F0706368376E0",
    "mp3" => true,
    "base64" => true,
    "link" => true,
    "quoted" => true,
    "openai_api_key" => "sk-proj-...",
];

curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Content-Type: application/json',
    'Authorization: Bearer zc_6FrX2qjM4bHT9pR6cC0sD8wLkG3nE2tZfV5uN1aP'
]);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$response = curl_exec($ch);
$data = json_decode($response, true);

echo "URL do arquivo: " . $data['fileURL'];
curl_close($ch);
?>
```

</RequestExample>

<ResponseExample>

```json 200
{
  "url": "https://api.exemplo.com/files/arquivo.mp3",
  "base64": "base64encodedstring",
  "mimetype": "audio/mpeg",
  "transcription": "Olá, gostaria de saber mais informações sobre o produto que você postou no status"
}
```

```json 400
{
  "success": false,
  "message": "Token de autenticação inválido"
}
```

</ResponseExample>
